window.__require=function t(e,o,r){function n(l,c){if(!o[l]){if(!e[l]){var u=l.split("/");if(u=u[u.length-1],!e[u]){var s="function"==typeof __require&&__require;if(!c&&s)return s(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+l+"'")}l=u}var a=o[l]={exports:{}};e[l][0].call(a.exports,function(t){return n(e[l][1][t]||t)},a,a.exports,t,e,o,r)}return o[l].exports}for(var i="function"==typeof __require&&__require,l=0;l<r.length;l++)n(r[l]);return n}({ActionButton:[function(t,e,o){"use strict";cc._RF.push(e,"13757xaRx1B27wfwetysyEc","ActionButton"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,i=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.showOnButton=function(t){this._currentSelectedButton=t,this.node.active=!0,this.node.position=t.node.position},e.prototype.onSelectionButton=function(t){if(cc.log(t.target.name),"btnAction"==t.target.name)cc.systemEvent.emit("deselectButton",this._currentSelectedButton);else{var e=parseInt(t.target.name);cc.systemEvent.emit("onSelectDir",this._currentSelectedButton,e)}this.node.active=!1},e=__decorate([n],e)}(cc.Component));o.default=i,cc._RF.pop()},{}],Board:[function(t,e,o){"use strict";cc._RF.push(e,"db3deUim0RCDZBpTEJAekfc","Board"),Object.defineProperty(o,"__esModule",{value:!0});var r=t("./ButtonActionNode"),n=t("./ActionButton"),i=t("./BulletPropertiesNode"),l=t("./TestBulletScene"),c=t("./BulletTypeNode"),u=t("./EmitterPropertiesNode"),s=cc._decorator,a=s.ccclass,p=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletProp=null,e.emitterProp=null,e.size=15,e.buttonNode=null,e.arrowNode=null,e.directionControl=null,e.bulletTypeNodes=[],e.listBulletNode=[],e.listCurrentArrowNode=[],e.listAction=[],e._lastProcessButton=null,e._currentButtonTypeGroup=null,e}return __extends(e,t),e.prototype.onLoad=function(){cc.systemEvent.on("deselectButton",this.onDeselectButton,this),cc.systemEvent.on("onSelectDir",this.onSelectButtonDir,this),cc.systemEvent.on("onSelectGroup",this.onSelectGroup,this),cc.systemEvent.on("onUndo",this.onUndo,this),cc.systemEvent.on("onRedo",this.onRedo,this)},e.prototype.onSelectGroup=function(t){switch(this._currentButtonTypeGroup&&this._currentButtonTypeGroup.onExit(),this._currentButtonTypeGroup=t.getComponent(c.default),t.name){case"BulletSpray":case"BulletDirection":this.setActiveButtonNode(!1),this._currentButtonTypeGroup.onEnter([this.midNode]);break;case"BulletTemplate":this.setActiveButtonNode(!0),this._currentButtonTypeGroup.onEnter([this.midNode])}},e.prototype.onDeselectButton=function(t){t.target.color=cc.Color.WHITE,t.node.getChildByName("dirSprite").active=!1},e.prototype.onSelectButtonDir=function(t,e){var o=t.node.getChildByName("dirSprite");o.active=!0,o.angle=45*e,t.target.color=cc.Color.GREEN;var n=new r.default(t,e);n._prevNode=this._lastProcessButton,this.listAction.length>0&&(this.listAction[this.listAction.length-1]._nextNode=n),this.listAction.push(n),this._lastProcessButton=n},e.prototype.onSelectButtonActionNode=function(t){var e=t._button.node.getChildByName("dirSprite");e.active=!0,e.angle=45*t._dir,t._button.target.color=cc.Color.GREEN,this.listAction.push(t),this._lastProcessButton=t},e.prototype.start=function(){var t=this.getComponent(cc.Layout),e=t.cellSize;this.node.setContentSize(cc.size(this.size*e.width+(this.size-1)*t.spacingX,this.size*e.height+(this.size-1)*t.spacingY));for(var o=0;o<this.size*this.size;++o){var r=cc.instantiate(this.buttonNode);r.name=o.toString(),r.setParent(this.node);var n=r.getComponent(cc.Button);n.interactable=!1,n.target.opacity=80,n.node.on("click",this.onSelectButton,this),this.listBulletNode.push(r.getComponent(cc.Button))}var i=~~(this.size*this.size/2);cc.log("Node INdex: ",i),this.midNode=this.listBulletNode[i].getComponent(cc.Button),this.midNode.target.color=cc.Color.RED,this.midNode.target.opacity=255},e.prototype.setActiveButtonNode=function(t){t||this.onClearBoard(),this.listBulletNode.forEach(function(e){e.interactable=t,e.target.opacity=t?255:80})},e.prototype.onSelectButton=function(t){this.midNode!=t&&this.directionControl.showOnButton(t)},e.prototype.onUndo=function(t){if(0!=this.listAction.length){var e=this.listAction.pop();this.onDeselectButton(e._button),this._lastProcessButton=e}},e.prototype.onRedo=function(t){null!=this._lastProcessButton&&this.listAction[this.listAction.length-1]!=this._lastProcessButton&&(this._lastProcessButton._button.target.color=cc.Color.GREEN,this.onSelectButtonActionNode(this._lastProcessButton),this._lastProcessButton=this._lastProcessButton._nextNode)},e.prototype.onChangeDir=function(t){var e=parseInt(t.string),o=~~(360/e),r=this.listCurrentArrowNode.length;if(r<o)for(var n=r;n<o;++n){var i=cc.instantiate(this.arrowNode);this.midNode.node.addChild(i,cc.macro.MAX_ZINDEX),this.listCurrentArrowNode.push(i)}else if(r>o)for(n=o;n<r;++n)this.listCurrentArrowNode[n].active=!1;var l=0;for(n=0;n<o;++n)this.listCurrentArrowNode[n].active=!0,this.listCurrentArrowNode[n].angle=l,l+=e},e.prototype.onClearBoard=function(){var t=this;this.listAction.forEach(function(e){t.onDeselectButton(e._button)}),this.listAction.length=0,this._lastProcessButton=null},e.prototype.getBoardData=function(){var t=this,e=[];return this.listAction.forEach(function(o){var r=o._dir,n=parseInt(o._button.name),i=~~(n/t.size),l={row:i,col:n-i*t.size,dir:r};e.push(l)}),e},e.prototype.getCurrentData=function(){var t=[];return this.bulletTypeNodes.forEach(function(e){t.push(e.getData())}),{BulletType:{CurrentType:this._currentButtonTypeGroup.node.name,bullet:t},BulletProperties:this.bulletProp.getBulletProperties(),EmitterProperties:this.emitterProp.getEmitterProperties()}},e.prototype.onSaveData=function(){var t=this.getCurrentData(),e=JSON.stringify(t);cc.log(e);var o=new Blob([e],{type:"text/plain"}),r=window.URL.createObjectURL(o),n=document.createElement("a");n.setAttribute("download","bullet.json"),n.href=r,document.body.appendChild(n),window.requestAnimationFrame(function(){var t=new MouseEvent("click");n.dispatchEvent(t),document.body.removeChild(n)})},e.prototype.onTestData=function(){var t=this.getCurrentData();cc.director.loadScene("testBulletScene",function(e,o){l.default.instance.initData(t)})},__decorate([p(i.default)],e.prototype,"bulletProp",void 0),__decorate([p(u.default)],e.prototype,"emitterProp",void 0),__decorate([p],e.prototype,"size",void 0),__decorate([p(cc.Prefab)],e.prototype,"buttonNode",void 0),__decorate([p(cc.Prefab)],e.prototype,"arrowNode",void 0),__decorate([p(n.default)],e.prototype,"directionControl",void 0),__decorate([p([c.default])],e.prototype,"bulletTypeNodes",void 0),e=__decorate([a],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./ActionButton":"ActionButton","./BulletPropertiesNode":"BulletPropertiesNode","./BulletTypeNode":"BulletTypeNode","./ButtonActionNode":"ButtonActionNode","./EmitterPropertiesNode":"EmitterPropertiesNode","./TestBulletScene":"TestBulletScene"}],BulletDirectionNode:[function(t,e,o){"use strict";cc._RF.push(e,"6f3d8P+FidOZq3q1lXYm2Rm","BulletDirectionNode"),Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BulletTypeNode"),n=cc._decorator,i=n.ccclass,l=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._emitterNode=null,e._arrowNodePool=null,e._arrowNodePoolSize=60,e._dirAngle=0,e}return __extends(e,t),e.prototype.start=function(){this._arrowNodePool=new cc.NodePool;for(var t=0;t<this._arrowNodePoolSize;++t){var e=cc.instantiate(this.arrowPrefab);this._arrowNodePool.put(e)}},e.prototype.onEnter=function(t){var e=t[0];this._emitterNode=e.node},e.prototype.onExit=function(){cc.log("On Exit");for(this._emitterNode.childrenCount;this._emitterNode.children.length>2;)this._emitterNode.children[2].active=!1,this._arrowNodePool.put(this._emitterNode.children[2])},e.prototype.onChangeDirAngle=function(t){this._dirAngle=parseInt(t.string);var e=~~(360/this._dirAngle),o=this._emitterNode.children.length-2;if(o<e)for(var r=o-2;r<e;++r){var n=this._arrowNodePool.get();n&&(n.active=!0,this._emitterNode.addChild(n,cc.macro.MAX_ZINDEX))}else if(o>e)for(;this._emitterNode.children.length-2>e;){(l=this._emitterNode.children[e]).active=!1,this._arrowNodePool.put(l)}var i=0;for(r=2;r<e+2;++r){var l;(l=this._emitterNode.children[r]).angle=i,i+=this._dirAngle}},e.prototype.getData=function(){return{Type:"BulletDirection",Properties:{angle:this._dirAngle}}},__decorate([l(cc.Prefab)],e.prototype,"arrowPrefab",void 0),e=__decorate([i],e)}(r.default);o.default=c,cc._RF.pop()},{"./BulletTypeNode":"BulletTypeNode"}],BulletPropertiesNode:[function(t,e,o){"use strict";cc._RF.push(e,"9bf2bv5V1NGBbU0eyKOV36u","BulletPropertiesNode"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,i=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletLinearGroup=null,e.bulletCurveGroup=null,e.txtBulletSpeed=null,e.txtBulletAccel=null,e.txtBulletJumpHeight=null,e.txtBulletJumpDistance=null,e.txtSprialSpeed=null,e}return __extends(e,t),e.prototype.getBulletProperties=function(){return{type:this.bulletCurveGroup.active?"Parabol":"Linear",speed:parseFloat(this.txtBulletSpeed.string),accel:parseFloat(this.txtBulletAccel.string),jumpHeight:parseFloat(this.txtBulletJumpHeight.string),jumpDistance:parseFloat(this.txtBulletJumpDistance.string),sprialSpeed:parseFloat(this.txtSprialSpeed.string)}},e.prototype.onSelectGroup=function(t){this.bulletCurveGroup.active="Curve"==t.node.name,this.bulletLinearGroup.active="Linear"==t.node.name},__decorate([i(cc.Node)],e.prototype,"bulletLinearGroup",void 0),__decorate([i(cc.Node)],e.prototype,"bulletCurveGroup",void 0),__decorate([i(cc.EditBox)],e.prototype,"txtBulletSpeed",void 0),__decorate([i(cc.EditBox)],e.prototype,"txtBulletAccel",void 0),__decorate([i(cc.EditBox)],e.prototype,"txtBulletJumpHeight",void 0),__decorate([i(cc.EditBox)],e.prototype,"txtBulletJumpDistance",void 0),__decorate([i(cc.EditBox)],e.prototype,"txtSprialSpeed",void 0),e=__decorate([n],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],BulletSprayNode:[function(t,e,o){"use strict";cc._RF.push(e,"c13e7VrRplCgo8YqIY0PLDH","BulletSprayNode"),Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BulletTypeNode"),n=cc._decorator,i=n.ccclass,l=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._emitterNode=null,e._arrowNodePool=null,e._arrowNodePoolSize=15,e._currentMinAngleArrow=null,e._currentMaxAngleArrow=null,e._lastNumDir=0,e}return __extends(e,t),e.prototype.start=function(){this._arrowNodePool=new cc.NodePool;for(var t=0;t<this._arrowNodePoolSize;++t){var e=cc.instantiate(this.arrowPrefab);this._arrowNodePool.put(e)}},e.prototype.onEnter=function(t){var e=t[0];this._emitterNode=e.node,this._currentMaxAngleArrow=null,this._currentMinAngleArrow=null,cc.log("on enter")},e.prototype.onExit=function(){this.clearArrowNode()},e.prototype.clearArrowNode=function(){for(;this._emitterNode.children.length>2;)this._emitterNode.children[2].active=!1,this._arrowNodePool.put(this._emitterNode.children[2])},e.prototype.clearInnerArrowNode=function(){for(;this._emitterNode.children.length>4;)this._emitterNode.children[4].active=!1,this._arrowNodePool.put(this._emitterNode.children[4])},e.prototype.onChangeMinDir=function(t){null==this._currentMinAngleArrow&&(this._currentMinAngleArrow=this._arrowNodePool.get(),this._currentMinAngleArrow.active=!0,this._emitterNode.addChild(this._currentMinAngleArrow,1e4)),cc.log(this._currentMinAngleArrow.name);var e=parseInt(t.string);this._currentMinAngleArrow.angle=e,this.OnPropertiesChange(this._lastNumDir)},e.prototype.onChangeMaxDir=function(t){null==this._currentMaxAngleArrow&&(this._currentMaxAngleArrow=this._arrowNodePool.get(),this._currentMaxAngleArrow.active=!0,this._emitterNode.addChild(this._currentMaxAngleArrow,1e4));var e=parseInt(t.string);this._currentMaxAngleArrow.angle=e,this.OnPropertiesChange(this._lastNumDir)},e.prototype.onChangeNumSpray=function(t){var e=parseInt(t.string);this._lastNumDir=e,this.OnPropertiesChange(e)},e.prototype.OnPropertiesChange=function(t){if(null!=this._currentMaxAngleArrow&&null!=this._currentMinAngleArrow){this.clearInnerArrowNode();for(var e=this._currentMaxAngleArrow.angle-this._currentMinAngleArrow.angle,o=t-2,r=(e=Math.abs(e))/(o+1),n=this._currentMinAngleArrow.angle+r,i=0;i<o;++i){var l=this._arrowNodePool.get();l.active=!0,this._emitterNode.addChild(l,1e4),l.angle=n,n+=r}}},e.prototype.getData=function(){return{Type:"BulletSpray",Properties:{minAngle:this._currentMinAngleArrow?this._currentMinAngleArrow.angle:0,maxAngle:this._currentMaxAngleArrow?this._currentMaxAngleArrow.angle:0,numSpray:this._lastNumDir}}},__decorate([l(cc.Prefab)],e.prototype,"arrowPrefab",void 0),e=__decorate([i],e)}(r.default);o.default=c,cc._RF.pop()},{"./BulletTypeNode":"BulletTypeNode"}],BulletTemplateNode:[function(t,e,o){"use strict";cc._RF.push(e,"1d514yBX9JMNJL0T6ehHQJS","BulletTemplateNode"),Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BulletTypeNode"),n=t("./Board"),i=cc._decorator,l=i.ccclass,c=i.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._emitterNode=null,e.board=null,e}return __extends(e,t),e.prototype.start=function(){},e.prototype.onEnter=function(t){var e=t[0];e.interactable=!0,e.target.opacity=255,this._emitterNode=e.node},e.prototype.onExit=function(){cc.log("On Exit")},e.prototype.onUndo=function(t){cc.systemEvent.emit("onUndo")},e.prototype.onRedo=function(t){cc.systemEvent.emit("onRedo")},e.prototype.getData=function(){return{Type:"BulletTemplate",Properties:{Template:this.board.getBoardData()}}},__decorate([c(n.default)],e.prototype,"board",void 0),e=__decorate([l],e)}(r.default);o.default=u,cc._RF.pop()},{"./Board":"Board","./BulletTypeNode":"BulletTypeNode"}],BulletTypeGroup:[function(t,e,o){"use strict";cc._RF.push(e,"f13a8agqSNKwIAerU9A2S6T","BulletTypeGroup"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,i=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletTypes=[],e.groupMap={},e.currentSelectGroup=null,e}return __extends(e,t),e.prototype.start=function(){var t=this;this.bulletTypes.forEach(function(e){t.groupMap[e.name]=e,e.active=!1}),this.currentSelectGroup=this.bulletTypes[0],this.currentSelectGroup.active=!0,cc.systemEvent.emit("onSelectGroup",this.currentSelectGroup)},e.prototype.onSelectionGroup=function(t){this.currentSelectGroup.active=!1,this.currentSelectGroup=this.groupMap[t.node.name],this.currentSelectGroup.active=!0,cc.systemEvent.emit("onSelectGroup",this.currentSelectGroup)},__decorate([i([cc.Node])],e.prototype,"bulletTypes",void 0),e=__decorate([n],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],BulletTypeNode:[function(t,e,o){"use strict";cc._RF.push(e,"59a50WNuExJyKW0P5fGVfuo","BulletTypeNode"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,i=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnter=function(t){},e.prototype.onExit=function(){},e.prototype.getData=function(){return{}},e=__decorate([n],e)}(cc.Component));o.default=i,cc._RF.pop()},{}],Bullet:[function(t,e,o){"use strict";cc._RF.push(e,"32c819XrzRAj4okmPlJvzkN","Bullet"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,i=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.shot=function(t,e,o){this.node.position=t,this._shotDir=e,this._speed=o,cc.log(this._speed)},e.prototype.shotByAngle=function(t,e,o){this.node.position=t,this.node.eulerAngles=new cc.Vec3(0,e,0),this._shotDir=new cc.Vec3(0,0,1);var r=cc.misc.degreesToRadians(e);this._shotDir.x=this._shotDir.x+Math.sin(r),this._shotDir.z=this._shotDir.z+Math.cos(r),cc.log("Shot Dir",this._shotDir),this._speed=1},e.prototype.update=function(){null!=this._shotDir&&(this.node.position=this.node.position.add(this._shotDir.multiplyScalar(this._speed)))},e=__decorate([n],e)}(cc.Component));o.default=i,cc._RF.pop()},{}],ButtonActionNode:[function(t,e,o){"use strict";cc._RF.push(e,"1b045U/YoFPN5lABK5+IuxZ","ButtonActionNode"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,i=(r.property,function(t){function e(e,o){var r=t.call(this)||this;return r._button=null,r._prevNode=null,r._nextNode=null,r._dir=0,r._button=e,r._dir=o,r}return __extends(e,t),e=__decorate([n],e)}(cc.Component));o.default=i,cc._RF.pop()},{}],EmitterPropertiesNode:[function(t,e,o){"use strict";cc._RF.push(e,"afa47z9CYdIE6eLweqgrzca","EmitterPropertiesNode"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=r.ccclass,i=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtWave=null,e.txtRate=null,e.txtSpinSpeed=null,e}return __extends(e,t),e.prototype.getEmitterProperties=function(){return{wave:parseInt(this.txtWave.string),rate:parseFloat(this.txtRate.string),spinSpeed:parseFloat(this.txtSpinSpeed.string)}},__decorate([i(cc.EditBox)],e.prototype,"txtWave",void 0),__decorate([i(cc.EditBox)],e.prototype,"txtRate",void 0),__decorate([i(cc.EditBox)],e.prototype,"txtSpinSpeed",void 0),e=__decorate([n],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],TestBulletScene:[function(t,e,o){"use strict";cc._RF.push(e,"292b7Lsf4ZCbb2KKw1Twzcl","TestBulletScene"),Object.defineProperty(o,"__esModule",{value:!0});var r=t("./Bullet"),n=cc._decorator,i=n.ccclass,l=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletEmitter=null,e.bulletPrefab=null,e.bulletPoolCount=10,e.bulletPool=null,e}var o;return __extends(e,t),o=e,e.prototype.onLoad=function(){o.instance=this},e.prototype.initData=function(t){cc.log(t)},e.prototype.getAvailableBullet=function(){var t=null;return this.bulletPool.size()>0?(t=this.bulletPool.get(),cc.log("Get Bullet From Pool")):t=cc.instantiate(this.bulletPrefab),t.active=!0,this.node.addChild(t),t},e.prototype.start=function(){this.bulletPool=new cc.NodePool;for(var t=0;t<this.bulletPoolCount;++t){var e=cc.instantiate(this.bulletPrefab);this.node.addChild(e),e.active=!0,this.bulletPool.put(e)}this.getAvailableBullet().getComponent(r.default).shotByAngle(this.bulletEmitter.position,180,1)},e.instance=null,__decorate([l(cc.Node)],e.prototype,"bulletEmitter",void 0),__decorate([l(cc.Prefab)],e.prototype,"bulletPrefab",void 0),__decorate([l],e.prototype,"bulletPoolCount",void 0),e=o=__decorate([i],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./Bullet":"Bullet"}]},{},["ActionButton","Board","Bullet","BulletDirectionNode","BulletPropertiesNode","BulletSprayNode","BulletTemplateNode","BulletTypeGroup","BulletTypeNode","ButtonActionNode","EmitterPropertiesNode","TestBulletScene"]);